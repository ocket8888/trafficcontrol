


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configure Federations &mdash; Traffic Control 3.0.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Configure Multi-Site Origin" href="multi_site.html" />
    <link rel="prev" title="Delivery Service Requests" href="ds_requests.html" />
    <link href="../../_static/theme_overrides.css" rel="stylesheet" type="text/css"/>


  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Traffic Control
          

          
            
            <img src="../../_static/ATC-SVG-FULL-WHITE.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../basics/index.html">CDN Basics</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Traffic Control Overview</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administrator’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../traffic_ops/configuration.html">Traffic Ops - Configuring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_ops/extensions.html">Managing Traffic Ops Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_ops/installation.html">Traffic Ops - Installing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_ops/using.html">Traffic Ops - Using</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_portal/installation.html">Traffic Portal Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_portal/usingtrafficportal.html">Traffic Portal - Using</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_monitor.html">Traffic Monitor Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_router.html">Traffic Router Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_router/migrationto2-3.html">Traffic Router - Migrating to 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_stats.html">Traffic Stats Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_server.html">Traffic Server Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traffic_vault.html">Traffic Vault Administration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Quick How To Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="anonymous_blocking.html">Configure Anonymous Blocking</a></li>
<li class="toctree-l3"><a class="reference internal" href="cachegroup_fallback.html">Configure Cache Group Fallbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="ciab.html">CDN in a Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="dnssec.html">Configure DNSSEC</a></li>
<li class="toctree-l3"><a class="reference internal" href="ds_requests.html">Delivery Service Requests</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Configure Federations</a></li>
<li class="toctree-l3"><a class="reference internal" href="multi_site.html">Configure Multi-Site Origin</a></li>
<li class="toctree-l3"><a class="reference internal" href="regionalgeo.html">Configure Regional Geo-blocking (RGB)</a></li>
<li class="toctree-l3"><a class="reference internal" href="static_dns.html">Configuring Static DNS Entries</a></li>
<li class="toctree-l3"><a class="reference internal" href="steering.html">Configure Delivery Service Steering</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Developer’s Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Traffic Ops API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Traffic Control</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Administrator’s Guide</a> &raquo;</li>
        
          <li><a href="index.html">Quick How To Guides</a> &raquo;</li>
        
      <li>Configure Federations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/admin/quick_howto/federations.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configure-federations">
<span id="federations-qht"></span><h1>Configure Federations<a class="headerlink" href="#configure-federations" title="Permalink to this headline">¶</a></h1>
<ol class="arabic">
<li><p>Create a user with a federations role (<span class="menuselection">User Admin ‣ Users ‣ ‘+’ button</span>). This user will need the ability to:</p>
<blockquote>
<div><ul class="simple">
<li><p>Create/edit/delete federations</p></li>
<li><p>Add IPV4 resolvers</p></li>
<li><p>Add IPV6 resolvers</p></li>
</ul>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/013.png"><img alt="../../_images/013.png" src="../../_images/013.png" style="width: 804.0px; height: 690.0px;" /></a>
</div>
</div></blockquote>
</li>
<li><p>As a user with administrative privileges, create a Federation Mapping by going to <span class="menuselection">Services ‣ :term:`Delivery Service</span>s –&gt; More –&gt; Federations` and then clicking <span class="guilabel">Add Federation Mapping</span>.</p></li>
<li><p>Choose the <a class="reference internal" href="../../glossary.html#term-delivery-service"><span class="xref std std-term">Delivery Service</span></a> to which the federation will be mapped and assign it to the Federation-role user; click <span class="guilabel">Add</span>.</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/023.png"><img alt="../../_images/023.png" src="../../_images/023.png" style="width: 766.0px; height: 494.0px;" /></a>
</div>
</div></blockquote>
</li>
<li><p>After the Federation is added, Traffic Ops will display the Federation. Changes can be made at this time or the Federation can be deleted. Notice that no resolvers have been added to the Federation yet. This can only be done by the Federation-role user to whom the Federated <a class="reference internal" href="../../glossary.html#term-delivery-service"><span class="xref std std-term">Delivery Service</span></a> was assigned. If no further action is necessary, the <span class="guilabel">Close</span> button will close the window and display the list of all Federations.</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/033.png"><img alt="../../_images/033.png" src="../../_images/033.png" style="width: 806.0px; height: 886.0px;" /></a>
</div>
</div></blockquote>
</li>
<li><p>The federation user logs into either the Traffic Ops API or the Traffic Portal UI and stores the Mojolicious cookie. The Mojolicious cookie can be obtained manually using the debug tools on a web browser or via a command line utility like <em class="manpage"><a class="manpage reference external" href="https://manpages.debian.org/curl(1)">curl(1)</a></em>.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-number">#69 </span><span class="caption-text">Example cURL Command</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>curl -i -XPOST <span class="s2">&quot;http://localhost:3000/api/1.1/user/login&quot;</span> -H <span class="s2">&quot;Content-Type: application/json&quot;</span> -d <span class="s1">&#39;{ &quot;u&quot;: &quot;federation_user1&quot;, &quot;p&quot;: &quot;password&quot; }&#39;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-number">#70 </span><span class="caption-text">Example API Response</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Wed, 02 Dec 2015 21:12:06 GMT</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">65</span>
<span class="na">Access-Control-Allow-Credentials</span><span class="o">:</span> <span class="l">true</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">Access-Control-Allow-Methods</span><span class="o">:</span> <span class="l">POST,GET,OPTIONS,PUT,DELETE</span>
<span class="na">Set-Cookie</span><span class="o">:</span> <span class="l">mojolicious=eyJleHBpcmVzIjoxNDQ5MTA1MTI2LCJhdXRoX2RhdGEiOiJmZWRlcmF0aW9uX3VzZXIxIn0---06b4f870d809d82a91433e92eae8320875c3e8b0; expires=Thu, 03 Dec 2015 01:12:06 GMT; path=/; HttpOnly</span>
<span class="na">Server</span><span class="o">:</span> <span class="l">Mojolicious (Perl)</span>
<span class="na">Access-Control-Allow-Headers</span><span class="o">:</span> <span class="l">Origin, X-Requested-With, Content-Type, Accept</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">no-cache, no-store, max-age=0, must-revalidate</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
<span class="na">Access-Control-Allow-Origin</span><span class="o">:</span> <span class="l">http://localhost:8080</span>

<span class="p">{</span><span class="nt">&quot;alerts&quot;</span><span class="p">:[{</span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;success&quot;</span><span class="p">,</span><span class="nt">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;Successfully logged in.&quot;</span><span class="p">}]}</span>
</pre></div>
</div>
</div>
</div></blockquote>
</li>
<li><p>The federation user sends a request to Traffic Ops to add IPV4 and/or IPV6 resolvers</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-number">#71 </span><span class="caption-text">Example cURL Command</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>curl -ki -H <span class="s2">&quot;Cookie: mojolicious=eyJleHBpcmVzIjoxNDQ5MTA1MTI2LCJhdXRoX2RhdGEiOiJmZWRlcmF0aW9uX3VzZXIxIn0---06b4f870d809d82a91433e92eae8320875c3e8b0;&quot;</span> -XPUT <span class="s1">&#39;http://localhost:3000/api/1.2/federations&#39;</span> -d <span class="s1">&#39;</span>
<span class="s1">{&quot;federations&quot;: [</span>
<span class="s1">    { &quot;deliveryService&quot;: &quot;images-c1&quot;,</span>
<span class="s1">      &quot;mappings&quot;:</span>
<span class="s1">        { &quot;resolve4&quot;: [ &quot;8.8.8.8/32&quot;, &quot;8.8.4.4/32&quot; ],</span>
<span class="s1">          &quot;resolve6&quot;: [&quot;2001:4860:4860::8888/128&quot;, &quot;2001:4860:4860::8844&quot;]</span>
<span class="s1">        }</span>
<span class="s1">    }</span>
<span class="s1">]}&#39;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-number">#72 </span><span class="caption-text">Example API Response</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Set-Cookie</span><span class="o">:</span> <span class="l">mojolicious=eyJleHBpcmVzIjoxNDQ5MTA1OTQyLCJhdXRoX2RhdGEiOiJmZWRlcmF0aW9uX3VzZXIxIn0---b42be0749415cefd1d14e1a91bb214845b4de556; expires=Thu, 03 Dec 2015 01:25:42 GMT; path=/; HttpOnly</span>
<span class="na">Server</span><span class="o">:</span> <span class="l">Mojolicious (Perl)</span>
<span class="na">Date</span><span class="o">:</span> <span class="l">Wed, 02 Dec 2015 21:25:42 GMT</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">74</span>
<span class="na">Access-Control-Allow-Credentials</span><span class="o">:</span> <span class="l">true</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">Access-Control-Allow-Methods</span><span class="o">:</span> <span class="l">POST,GET,OPTIONS,PUT,DELETE</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">no-cache, no-store, max-age=0, must-revalidate</span>
<span class="na">Access-Control-Allow-Origin</span><span class="o">:</span> <span class="l">http://localhost:8080</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
<span class="na">Access-Control-Allow-Headers</span><span class="o">:</span> <span class="l">Origin, X-Requested-With, Content-Type, Accept</span>

<span class="p">{</span><span class="nt">&quot;response&quot;</span><span class="p">:</span><span class="s2">&quot;federation_user1 successfully created federation resolvers.&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div></blockquote>
</li>
<li><p>The resolvers added by the Federation-user will now visible in Traffic Portal.</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/042.png"><img alt="../../_images/042.png" src="../../_images/042.png" style="width: 802.0px; height: 875.0px;" /></a>
</div>
</div></blockquote>
</li>
</ol>
<p>Any requests made from a client that resolves to one of the federation resolvers will now be given a <abbr title="Canonical Name">CNAME</abbr> Record from Traffic Router.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-number">#73 </span><span class="caption-text">Example DNS request (via <code class="docutils literal notranslate"><span class="pre">dig</span></code>)</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>dig @tr.kabletown.net foo.images-c1.kabletown.net
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-number">#74 </span><span class="caption-text">Example Resolver Response</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-DNS notranslate"><div class="highlight"><pre><span></span><span class="c c-Singleline">; &lt;&lt;&gt;&gt; DiG 9.7.3-RedHat-9.7.3-2.el6 &lt;&lt;&gt;&gt; @tr.kabletown.net foo.images-c1.kabletown.net</span>
<span class="c c-Singleline">; (1 server found)</span>
<span class="c c-Singleline">;; global options: +cmd</span>
<span class="c c-Singleline">;; Got answer:</span>
<span class="o">;;</span> <span class="k">-&gt;&gt;HEADER&lt;&lt;-</span> <span class="nv">opcode</span><span class="o">:</span> <span class="s">QUERY</span>, <span class="nv">status</span><span class="o">:</span> <span class="s">NOERROR</span>, <span class="nv">id</span><span class="o">:</span> <span class="s">45110</span>
<span class="o">;;</span> <span class="nv">flags</span><span class="o">:</span> <span class="s">qr</span> <span class="s">rd</span><span class="k">;</span> <span class="nv">QUERY</span><span class="o">:</span> <span class="s">1</span>, <span class="nv">ANSWER</span><span class="o">:</span> <span class="s">1</span>, <span class="nv">AUTHORITY</span><span class="o">:</span> <span class="s">0</span>, <span class="nv">ADDITIONAL</span><span class="o">:</span> <span class="s">0</span>
<span class="o">;;</span> <span class="gu">WARNING</span><span class="o">:</span> <span class="err">recursion requested but not available</span>

<span class="o">;;</span> <span class="gh">QUESTION SECTION:</span>
<span class="s">;foo.images-c1.kabletown.net.   IN A</span>

<span class="o">;;</span> <span class="gh">ANSWER SECTION:</span>
<span class="s">foo.images-c1.kabletown.net.</span>    <span class="m">30</span> <span class="s">IN</span> <span class="s">CNAME</span> <span class="s">img.mega-cdn.net.</span>

<span class="o">;;</span> <span class="s">Query</span> <span class="nv">time</span><span class="o">:</span> <span class="s">9</span> <span class="s">msec</span>
<span class="o">;;</span> <span class="nv">SERVER</span><span class="o">:</span> <span class="s">10.10.10.10#53(10.10.10.10)</span>
<span class="o">;;</span> <span class="gu">WHEN</span><span class="o">:</span> <span class="ld">Wed Dec  2 22:05:26 2015</span>
<span class="o">;;</span> <span class="s">MSG</span> <span class="s">SIZE</span>  <span class="nv">rcvd</span><span class="o">:</span> <span class="s">84</span>
</pre></div>
</div>
</div>
</div></blockquote>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="multi_site.html" class="btn btn-neutral float-right" title="Configure Multi-Site Origin" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ds_requests.html" class="btn btn-neutral" title="Delivery Service Requests" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Apache Traffic Control

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>